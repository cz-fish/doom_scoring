#library "Score"
#include "zcommon.acs"

#define MAX_PLAYERS 8
int score[MAX_PLAYERS] = {0, 0, 0, 0, 0, 0, 0, 0};

script 1 OPEN
{
  GiveInventory("PlasmaRifle", 1);
  GiveInventory("Cell", 200);
}

script 4 ENTER
{
  int addPoints = CheckInventory("Points");
  if (addPoints > 0)
  {
    score[PlayerNumber()] += addPoints;
    TakeInventory("Points", addPoints);
  }

  SetHudSize(800, 600, TRUE);
  HudMessage(s:"Points:"; HUDMSG_PLAIN, 102, CR_WHITE, 5.1, 5.1, 0);
  int y = 25.1;
  int best = GetBestPlayerNumber();
  for (int i = 0; i < PlayerCount(); i++)
  {
    if (i == best)
    {
      HudMessage(n:i, s:": ", i:score[i]; HUDMSG_PLAIN, 103 + i, CR_GOLD, 5.1, y, 0);
    }
    else
    {
      HudMessage(n:i, s:": ", i:score[i]; HUDMSG_PLAIN, 103 + i, CR_GREEN, 5.1, y, 0);
    }
    y += 16.0;
  }
  Delay(5);
  Restart;
}

function int GetBestPlayerNumber(void)
{
  int best = 0;
  int maxscore = score[0];
  for (int i = 1; i < PlayerCount(); i++)
  {
    if (score[i] > maxscore)
    {
      best = i;
      maxscore = score[i];
    }
  }
  return best;
}

